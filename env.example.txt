# ============================================
# Configurazione Sistema di Sicurezza
# Copia questo file come .env.local e configura le variabili
# ============================================

# --- Geoblocking ---
# Abilita/disabilita geoblocking (default: true)
GEO_BLOCKING_ENABLED=true
# Permetti IP con paese sconosciuto (default: true - pi√π permissivo per evitare falsi positivi)
# Imposta a false per bloccare IP con paese sconosciuto
GEO_BLOCK_ALLOW_UNKNOWN=true
# Codice HTTP per geoblocking (451 o 403)
GEO_BLOCK_STATUS_CODE=451
# Messaggio personalizzato per geoblocking
GEO_BLOCK_MESSAGE=This website is not available in your country.

# --- Rate Limiting ---
# Numero massimo di richieste per finestra temporale
RATE_LIMIT_MAX_REQUESTS=100
# Finestra temporale in millisecondi (default: 60000 = 1 minuto)
RATE_LIMIT_WINDOW_MS=60000
# Burst allowance
RATE_LIMIT_BURST=10

# --- Redis (opzionale, per rate limiting distribuito) ---
# URL Redis per rate limiting distribuito (es: redis://localhost:6379)
# Se non specificato, usa store in-memory
REDIS_URL=

# --- VPN Detection ---
# Abilita/disabilita rilevamento VPN (default: true)
VPN_DETECTION_ENABLED=true
# Soglia di confidence minima per bloccare VPN (0-100, default: 50)
VPN_CONFIDENCE_THRESHOLD=50
# Blocca IP da datacenter/hosting (default: false)
VPN_BLOCK_DATACENTER=false
# Blocca IP Tor (default: true)
VPN_BLOCK_TOR=true

# --- DDoS Protection ---
# Abilita/disabilita protezione DDoS (default: true)
DDOS_PROTECTION_ENABLED=true
# Soglia per richiedere challenge CAPTCHA (0-100, default: 60)
DDOS_CHALLENGE_THRESHOLD=60
# Soglia per bloccare richiesta (0-100, default: 80)
DDOS_BLOCK_THRESHOLD=80
# Abilita CAPTCHA challenge (default: false)
DDOS_ENABLE_CAPTCHA=false

# --- API Keys per Servizi Esterni ---
# IP-API.com (fallback per geolocalizzazione e VPN detection)
# Ottieni chiave: https://ip-api.com/docs/api:json
IP_API_KEY=

# IPHub API (rilevamento VPN/Proxy)
# Ottieni chiave: https://iphub.info/
IPHUB_API_KEY=

# GetIPIntel API (rilevamento VPN/Proxy)
# Ottieni chiave: http://getipintel.net/
GETIPINTEL_API_KEY=

# IP Quality Score API (rilevamento VPN/Proxy avanzato)
# Ottieni chiave: https://www.ipqualityscore.com/
IPQS_API_KEY=

# MaxMind GeoIP2 API (geolocalizzazione avanzata)
# Ottieni chiave: https://www.maxmind.com/en/accounts/current/license-key
MAXMIND_LICENSE_KEY=

# --- Whitelist IP ---
# IP amministrativi che bypassano tutti i controlli (separati da virgola)
# Esempio: ADMIN_IP_WHITELIST=192.168.1.1,10.0.0.1
ADMIN_IP_WHITELIST=

# IP che bypassano solo geoblocking (separati da virgola)
GEO_IP_WHITELIST=

# --- Logging ---
# Endpoint per inviare log di sicurezza (opzionale)
# Esempio: SECURITY_LOG_ENDPOINT=https://logs.example.com/api/security
SECURITY_LOG_ENDPOINT=
